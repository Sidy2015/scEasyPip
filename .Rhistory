obj <- Seurat::NormalizeData(obj, normalization.method = "LogNormalize", scale.factor = 10000, verbose=F)
obj <- Seurat::FindVariableFeatures(obj, selection.method = "vst", nfeatures = 2000, verbose=F)
obj <- Seurat::ScaleData(obj, features = rownames(obj),verbose=F)
}
print(obj)
#CLUSTERING
print('Dimensional Reduction')
obj <- Seurat::RunPCA(obj, verbose = FALSE)
save_plot('outs/ElbowPlot',Seurat::ElbowPlot(obj, ndims = ndims))
print('Clustering')
obj <- Seurat::FindNeighbors(obj, dims = dims, verbose = FALSE)
obj <- Seurat::FindClusters(obj, resolution = resolution, verbose = FALSE)
print('Running UMAP ...')
obj <- Seurat::RunUMAP(obj, dims = dims, umap.method = "umap-learn")
#obj <- Seurat::FindClusters(obj, resolution = 0.3, verbose = FALSE)
if (sctransform) {
save_plot('outs/clustree',clustree(obj, prefix = 'SCT_snn_res.'))
}
save_plot('outs/clustree_overlay',clustree_overlay(
obj,
red_dim = "umap",
x_value = "umap1",
y_value = "umap2"
))
save_plot('outs/DimPlot_umap',Seurat::DimPlot(obj, reduction = 'umap', label = TRUE))
save_plot('outs/Dimplot_umap_orig.ident',Seurat::DimPlot(obj, reduction = 'umap', group.by = 'orig.ident'))
if (cellcycle) {
print('Cell Cycling Scoring')
s.genes <- str_to_title(tolower(cc.genes$s.genes))
g2m.genes <- str_to_title(tolower(cc.genes$g2m.genes))
obj <-
Seurat::CellCycleScoring(
obj,
s.features = s.genes,
g2m.features = g2m.genes,
set.ident = FALSE
)
save_plot('outs/cellcycle',Seurat::DimPlot(obj, reduction = 'umap', label = TRUE))
}
if (!is.null(genes.FeaturePlot)) {
save_plot('outs/FeaturePlot',Seurat::FeaturePlot(obj, features = genes.FeaturePlot))
}
if (!is.null(genes.DotPlot)) {
save_plot('outs/DotPlot',Seurat::DotPlot(obj, features = genes.DotPlot))
}
if (find.all.markers) {
print('Finding Markers')
obj_markers <-
Seurat::FindAllMarkers(
obj,
only.pos = only.pos,
min.pct = min.pct,
logfc.threshold = logfc.threshold,
test.use = test.use
)
write.csv(obj_markers, 'markers_obj.csv')
}
return(obj)
}
#' Save output plot in png format
#'
#' @param filename The filename under which to save the plot
#' @param plot The plot to save
#'
#' @return  The plot saved as a png image
#'
#' @export
save_plot <-function(filename,plot){
png(filename = paste0(filename,".png"), width = 720, height = 576)
plot
dev.off()
}
if (is.null(c(max.features,max.nCount))){print('T')}
if (is.null(c(max.features,max.nCount))){print('T')}
max.features=2
max.nCount=NULL
if (is.null(c(max.features,max.nCount))){print('T')}
if (is.null(max.features)){print('T')}
if (is.null(max.nCount)){print('T')}
setwd("C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package")
read_10Xdata <- function(data.dir, min.cells, min.features, mt.pattern, project.name){
obj.data <- Read10X(data.dir = data.dir)
obj <- CreateSeuratObject(counts = obj.data, project = project.name, min.cells = min.cells, min.features = min.features)
obj[["percent.mt"]] <- PercentageFeatureSet(obj, pattern = mt.pattern[2])
print(FeatureScatter(obj, feature1 = "nFeature_RNA", feature2 = "percent.mt"))
print(FeatureScatter(obj, feature1 = "nCount_RNA", feature2 = "nFeature_RNA"))
return(obj)
}
obj <- read_10Xdata(data.dir=getwd(), min.cells = 3, min.features = 200, mt.pattern = c('^MT-','^mt-'), project.name='SeuratProject')
read_10Xdata <- function(data.dir, min.cells, min.features, mt.pattern, project.name){
obj.data <- Read10X(data.dir = data.dir)
obj <- CreateSeuratObject(counts = obj.data, project = project.name, min.cells = min.cells, min.features = min.features)
obj[["percent.mt"]] <- PercentageFeatureSet(obj, pattern = mt.pattern[2])
print(FeatureScatter(obj, feature1 = "nFeature_RNA", feature2 = "percent.mt"))
print(FeatureScatter(obj, feature1 = "nCount_RNA", feature2 = "nFeature_RNA"))
return(obj)
}
library(Seurat)
obj <- read_10Xdata(data.dir=getwd(), min.cells = 3, min.features = 200, mt.pattern = c('^MT-','^mt-'), project.name='SeuratProject')
mean(obj$nCount_RNA)
max(obj$nCount_RNA)
quantile(obj$nCount_RNA, 0.975)
FeatureScatter(obj, feature1 = "nFeature_RNA", feature2 = "percent.mt")
FeatureScatter(obj, feature1 = "nFeature_RNA", feature2 = "nCount_RNA")
obj <- read_10Xdata(data.dir=getwd(), min.cells = 3, min.features = 200, mt.pattern = c('^MT-','^mt-'), project.name='SeuratProject')
max(obj$nCount_RNA)
FeatureScatter(obj, feature1 = "nFeature_RNA", feature2 = "nCount_RNA")
quantile(obj$nCount_RNA, 0.975)
max(quantile(obj$nCount_RNA, 0.975))
>quantile()
quantile()
?quantile()
FeatureScatter(obj, feature1 = "nFeature_RNA", feature2 = "nCount_RNA")
quantile(obj$nCount_RNA, 0.97)
quantile(obj$nCount_RNA, 0.97)[1]
quantile(obj$nCount_RNA, 0.97,names = F)
library(scEasyPip)
run_pipeline('.')
run_pipeline('.')
library(scEasyPip)
run_pipeline('.')
paste0(NULL,'test')
library(scEasyPip)
run_pipeline(data.dir = '.', output.dir = 'scEasyPip/scEasyPip/outs/')
run_pipeline(data.dir = '.', output.dir = 'scEasyPip/scEasyPip/outs')
setwd("C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/scEasyPip/scEasyPip")
run_pipeline(data.dir = '../../.')
library(scEasyPip)
run_pipeline(data.dir = '../../.')
library(scEasyPip)
run_pipeline(data.dir = '../../.')
run_pipeline(data.dir = '../../.', output.dir='outs/')
library(scEasyPip)
run_pipeline(data.dir = '../../.', output.dir='outs/')
document()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
use_mit_license()
usethis::use_mit_license()
devtools::check()
devtools::check()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
library(scEasyPip)
devtools::document()
setwd("C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/scEasyPip/scEasyPip")
devtools::document()
rm(list = c("read_10Xdata", "save_plot"))
devtools::document()
devtools::load_all(".")
devtools::document()
devtools::check()
run_pipeline(data.dir = '../../.', output.dir = '../../outs/')
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = '../../outs/')
run_pipeline(data.dir = '../../.', output.dir = getwd(../../outs/))
getwd(../../outs/)
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
devtools::document()
devtools::check()
library(scEasyPip)
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
obj
Seurat::FeatureScatter(obj, feature1 = "nFeature_RNA", feature2 = "percent.mt"))
Seurat::FeatureScatter(obj, feature1 = "nFeature_RNA", feature2 = "percent.mt")
Seurat::FeatureScatter(obj, feature1 = "nFeature_RNA", feature2 = "percent.mt")+geom_hline(max.percent.mt)
max.percent.mt = 15
Seurat::FeatureScatter(obj, feature1 = "nFeature_RNA", feature2 = "percent.mt")+geom_hline(max.percent.mt)
Seurat::FeatureScatter(obj, feature1 = "nFeature_RNA", feature2 = "percent.mt")+geom_hline(yintercept = max.percent.mt, linetype='dashed')
Seurat::FeatureScatter(obj, feature1 = "nCount_RNA", feature2 = "nFeature_RNA")+geom_hline(yintercept = max.percent.mt, linetype='dashed')
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::document()
devtools::check()
devtools::document()
BiocManager::install("MAST")
devtools::document()
devtools::check()
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
round(max.features)
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::document()
library(scEasyPip)
devtools::load_all(".")
library(scEasyPip)
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
devtools::load_all(".")
run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
obj<- run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
obj<- run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
getwd()
obj<- run_pipeline(data.dir = '../../.')
devtools::load_all(".")
gc()
obj<- run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
devtools::load_all(".")
obj<- run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
devtools::load_all(".")
devtools::document()
devtools::check()
devtools::load_all(".")
library(scEasyPip)
obj<- run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
View(obj)
devtools::load_all(".")
obj<- run_pipeline(data.dir = '../../.', output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
?run_pipeline
?run_10xdata
path <- 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/'
exp <- list.files(path)
exp
devtools::document()
devtools::document()
devtools::check()
devtools::load_all(".")
library(scEasyPip)
run_integration()
run_integration(rds.list = c('../../../../samhita/raw_rds/good_rds/batch1_exp5.RDS','../../../../samhita/raw_rds/good_rds/'))
devtools::load_all(".")
run_integration(rds.list = c('../../../../samhita/raw_rds/good_rds/batch1_exp5.RDS','../../../../samhita/raw_rds/good_rds/'))
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'))
rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS')
rds.list <- lapply(X = rds.list, FUN = function(x){readRDS(x)})
print(rds.list)
!('SCT' %in% Assays(rds[[1]]))
!('SCT' %in% Assays(rds.list[[1]]))
!('SCT' %in% Assays(rds.list))
devtools::load_all(".")
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'))
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'))
devtools::load_all(".")
devtools::load_all(".")
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'))
devtools::document()
devtools::check()
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'))
devtools::load_all(".")
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'), output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
devtools::load_all(".")
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'), output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
devtools::load_all(".")
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'), output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
devtools::load_all(".")
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'), output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
saveRDS(rds.list[[1]], 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
saveRDS(rds.list[[1]], 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs')
saveRDS(rds.list[[1]], 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
saveRDS(rds.list[[1]], 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/')
saveRDS(rds.list[[1]], 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop')
saveRDS(rds.list[[1]])
saveRDS(rds.list[[1]], getwd())
devtools::load_all(".")
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'), output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
devtools::load_all(".")
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'), output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
devtools::load_all(".")
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'), output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
devtools::load_all(".")
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'), output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
devtools::load_all(".")
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'), output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
load("C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/_obj.integrated.Rds")
obj.integrated<-readRDS("C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/_obj.integrated.Rds")
obj.integrated
View(obj.integrated)
devtools::load_all(".")
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'), output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
devtools::document()
devtools::check()
devtools::load_all(".")
library(scEasyPip)
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'), output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
library(scEasyPip)
devtools::load_all(".")
run_integration(rds.list = c('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp5.RDS','C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/samhita/raw_rds/good_rds/batch1_exp6.RDS'), output.dir = 'C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/')
devtools::document()
help(p = "read_10xdata")
help(p = "scEasyPip::read_10xdata")
help(p = "run_seurat")
?run_seurat
?read_10xdata
devtools::document()
devtools::check()
library(scEasyPip)
library(scEasyPip)
devtools::document()
devtools::check()
library(scEasyPip)
library(scEasyPip)
seurat.obj <- readRDS('../../../../Aging/Aging_epi/epi.merged.rds')
library(Seurat)
seurat.obj <- FindClusters(seurat.obj, resolution = seq(0.1,1,0.1), algorithm = 1)
library(cluster)
View(seurat.obj)
as.data.frame(seurat.obj@meta.data[["SCT_snn_res.0.9"]])
cbind(as.data.frame(seurat.obj@meta.data[["SCT_snn_res.0.9"]],as.data.frame(seurat.obj@meta.data[["SCT_snn_res.0.1"]])
)
)
cbind(as.data.frame(seurat.obj@meta.data[["SCT_snn_res.0.9"]]),as.data.frame(seurat.obj@meta.data[["SCT_snn_res.0.1"]]))
df <- cbind(as.data.frame(seurat.obj@meta.data[["SCT_snn_res.0.9"]]),as.data.frame(seurat.obj@meta.data[["SCT_snn_res.0.1"]]))
colname(df)<-c('cluster.1','cluster.2')
colnamea(df)<-c('cluster.1','cluster.2')
colnames(df)<-c('cluster.1','cluster.2')
View(df)
clusGap(seurat.obj@assays[["SCT"]]@scale.data, df,K.max, B = 100)
read.csv('../../outs/markers_obj.csv')
read.csv('../../outs/markers_obj.csv', row.names = 1)
df <- read.csv('../../outs/markers_obj.csv', row.names = 1)
library(pheatmap)
pheatmap(df)
View(df)
View(df)
View(df[,c('avg_log2FC','cluster')])
df[,c('avg_log2FC','cluster')]
pheatmap(df[,c('avg_log2FC','cluster')])
pheatmap(t(df[,c('cluster')]))
pheatmap(t(df[,'cluster']))
pheatmap(t(df[,cluster]))
pheatmap(t(df[,cluster]), cluster_cols = F, cluster_rows = F)
pheatmap(t(df[,'cluster']), cluster_cols = F, cluster_rows = F)
pheatmap(t(df[c('Lgr5','Dmbt1'),'cluster']), cluster_cols = F, cluster_rows = F)
library(dorothea)
library(dplyr)
library(Seurat)
library(tibble)
library(pheatmap)
library(tidyr)
library(viper)
library(clustree)
devtools::load_all(".")
devtools::document()
devtools::check()
devtools::document()
devtools::document()
devtools::document()
devtools::load_all(".")
devtools::document()
dorothea::df2regulon()
devtools::load_all(".")
run_tfactivity_pipeline(seurat.obj)
devtools::load_all(".")
devtools::load_all(".")
run_tfactivity_pipeline(seurat.obj)
devtools::load_all(".")
seurat.obj <- run_tfactivity_pipeline(seurat.obj)
devtools::load_all(".")
devtools::load_all(".")
seurat.obj <- run_tfactivity_pipeline(seurat.obj)
View(seurat.obj)
View(seurat.obj)
View(seurat.obj)
devtools::load_all(".")
seurat.obj <- run_tfactivity_pipeline(seurat.obj)
test <- run_tfactivity(seurat.obj)
View(test)
plot(test@assays[["dorothea"]]@data)
devtools::load_all(".")
test <- run_tfactivity(seurat.obj)
View(test)
test_obj <- run_tfactivity_pipeline(seurat.obj)
View(seurat.obj)
View(test)
DefaultAssay(test)
test<-Seurat::FindClusters(test, resolution = seq(0.1,0.4,0.1), verbose = FALSE)
test<-Seurat::FindNeighbors(test, dims = 1:10, verbose = FALSE)
test<-Seurat::FindClusters(test, resolution = seq(0.1,0.4,0.1), verbose = FALSE)
test<-Seurat::FindNeighbors(test, dims = 1:10, verbose = FALSE)
View(test)
test<-Seurat::FindNeighbors(test, dims = 1:10, verbose = FALSE)
test<-Seurat::FindClusters(test, resolution = seq(0.1,0.4,0.1), verbose = FALSE)
test<-Seurat::FindClusters(test, resolution = 0.5, verbose = FALSE)
test<-FindClusters(test, resolution = 0.5, verbose = FALSE)
test<-FindClusters(test, resolution = 0.5, verbose = FALSE, graph.name='SCT.snn')
View(seurat.obj)
View(test)
grepl('^SCT',x = test@meta.data)
grepl('^SCT',x = rownames(test@meta.data))
colnames(test@meta.data)
grepl('^SCT',x = colnames(test@meta.data))
'^SCT' %in% colnames(test@meta.data)
'SCT' %in% colnames(test@meta.data)
TRUE | grepl('^SCT',x = colnames(test@meta.data))
TRUE %in% grepl('^SCT',x = colnames(test@meta.data))
TRUE %in% grepl('^RNA',x = colnames(test@meta.data))
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(seurat.obj)
View(seurat.obj)
devtools::load_all(".")
View(seurat.obj)
test_obj <- run_tfactivity_pipeline(seurat.obj)
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(seurat.obj)
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(seurat.obj)
?data
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::load_all(".")
devtools::document()
test_obj <- run_tfactivity_pipeline(seurat.obj)
library(clustree)
test_obj <- run_tfactivity_pipeline(seurat.obj)
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(seurat.obj)
#test_obj <- run_tfactivity_pipeline(seurat.obj, output.dir = getwd())
getwd()
devtools::load_all(".")
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(seurat.obj)
#saveRDS(obj, file = paste(output.dir,'/seurat.obj.Rds'))
getwd()
saveRDS(test, file = paste('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/scEasyPip/scEasyPip','/seurat.obj.Rds'))
saveRDS(test, file = paste0('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/scEasyPip/scEasyPip','/seurat.obj.Rds'))
devtools::load_all(".")
saveRDS(test, file = paste0('C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/scEasyPip/scEasyPip','/seurat.obj.Rds'))
test_obj <- run_tfactivity_pipeline(seurat.obj)
devtools::load.all('.')
devtools::load_all(".")
devtools::document()
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/')
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/')
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/')
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/')
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/')
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/')
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/')
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/')
devtools::load_all(".")
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/')
devtools::load_all(".")
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/')
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/', dims=1:10)
1:10
max(1:10)
devtools::load_all(".")
max(1:10)
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/', dims=1:10)
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/', dims=1:10)
devtools::load_all(".")
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/', dims=1:10)
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/', dims=1:10)
devtools::load_all(".")
test_obj <- run_tfactivity_pipeline(data.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package', output.dir='C:/Users/tb2928.admin.BB08MPUL87-SC/OneDrive - cumc.columbia.edu/Desktop/scRNA_seq_SEURAT/scRNA_package/outs/test/', dims=1:10)
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::load_all(".")
devtools::check()
